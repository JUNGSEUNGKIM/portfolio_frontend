# ⚙️ Docker Compose로 시작하는 서버 인프라 설계

## ✅ 문서 개요

이 문서는 포트 폴리오 웹 프로젝트를 운영하기 위한 서버 인프라를 **Docker Compose** 기반으로 설계한 이유, 기존 방식과의 차이점, 쿠버네티스 도입 전 단계로서의 Compose의 역할 등을 정리한 것입니다.

---

## 🐳 Docker Compose를 선택한 이유

### 1. 단일 개발자 환경에서 가장 현실적인 선택
- 풀스택 개발자가 **백엔드/프론트/DB/Reverse Proxy**를 직접 컨트롤할 수 있어야 하며,
- 복잡한 오케스트레이션(Kubernetes)은 **학습 비용과 운영 비용이 과도**함

### 2. 단순하고 명확한 서비스 정의
- `docker-compose.yml` 하나로 전체 인프라를 설명 가능
- 서비스별 의존 관계를 `depends_on`으로 간단하게 표현 가능
- 볼륨, 네트워크, 환경변수 설정이 직관적

---

## 📍 기존 직접 배포 방식과의 차이점

| 항목 | 기존 방식 (직접 실행) | Docker Compose |
|------|------------------------|----------------|
| 실행 방식 | `node main.js`, `npm run build` 등 수동 실행 | `docker compose up` 한 줄로 전체 실행 |
| 환경 격리 | 없음 (호스트와 공유) | 완전 격리된 컨테이너 환경 |
| 배포 자동화 | SSH 접속 후 스크립트 실행 | CI/CD + 이미지 배포로 자동화 가능 |
| 설정 관리 | 디렉터리별 수동 관리 | `.env`, `volumes`, `bind mounts`로 통합 관리 |
| 확장성 | 확장 어려움 | Docker Swarm or Kubernetes로 확장 가능 |

---

## 📍 홈서버에 Docker Compose가 적합한 이유

### ✅ Docker Compose vs Kubernetes

| 항목 | Docker Compose | Kubernetes |
|------|----------------|------------|
| 사용 목적 | 개발/소규모 배포 | 대규모 오케스트레이션 |
| 복잡도 | 낮음 (단일 파일) | 높음 (다양한 YAML 구성) |
| 운영 방식 | 단일 서버 중심 | 다중 노드 클러스터 |
| 추천 상황 | 홈서버, 소규모 서비스 | 마이크로서비스, 프로덕션 규모 |


### ✅ 리소스가 제한된 환경에 적합
- Kubernetes는 메모리 및 CPU를 많이 소모하며, 실운영 홈서버에서는 **오버스펙**
- Compose는 가벼운 오케스트레이션 기능만 제공하므로 8GB RAM 환경에서도 안정적으로 운영 가능

### ✅ 유지보수의 단순성
- 로컬 또는 SSH 원격에서 `docker compose ps`, `logs`, `restart` 등으로 **직관적인 운영** 가능
- 개발 → 테스트 → 운영을 동일한 방식으로 진행 가능

### ✅ 트러블슈팅 용이
- 컨테이너 단위로 로그 확인, 재시작 가능
- 특정 서비스만 따로 내려서 디버깅 가능 (`docker compose restart backend`)

---

## 🔄 Kubernetes 도입 전 단계로서의 Compose

| Compose 역할 | 설명 |
|--------------|------|
| 구조화 훈련 | 서비스 분리, 네트워크 관리, 환경변수 분리 등 기본 개념 익히기 |
| IaC 연습 | `docker-compose.yml`이 곧 인프라 문서 |
| 이미지 중심 사고 | 코드가 아닌 이미지로 배포, 무상태 구조 이해 |
| CI/CD 연결 | GitHub Actions로 빌드 & 배포 자동화 연결 실습 |

---

## 📍 결론

Docker Compose는 홈서버와 같이 **개발자 개인이 전체를 운영하는 환경**에서 가장 효율적인 선택이다.  
Kubernetes로의 전환 전에도 실전 경험을 쌓기에 충분하며, 운영 자동화, CI/CD, 서비스 분리 구조까지 담을 수 있다.

> 복잡함보다는 실용성에 집중하고, **확장성을 고려한 작고 단단한 인프라**를 먼저 완성한다는 철학으로 접근했다.

