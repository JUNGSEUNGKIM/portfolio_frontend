# âœ… ê°œë°œìš© Docker í™˜ê²½ êµ¬ì¶• ì •ë¦¬ (frontend-dev / backend-dev)

## ğŸ“ í´ë” êµ¬ì¡°
```
/opt/home-server/
â”œâ”€â”€ backend-dev/            # NestJS ê°œë°œìš© í”„ë¡œì íŠ¸
â”‚   â””â”€â”€ Dockerfile          # ê°œë°œìš© (start:dev)
â”œâ”€â”€ frontend-dev/           # Vite + React ê°œë°œìš© í”„ë¡œì íŠ¸
â”‚   â””â”€â”€ Dockerfile          # ê°œë°œìš© (npm run dev)
â”œâ”€â”€ nginx/
â”‚   â””â”€â”€ conf.d/
â”‚       â””â”€â”€ test.domain.com.conf  # nginx í”„ë¡ì‹œ ì„¤ì •
â”œâ”€â”€ docker-compose.yml
```
---

## ğŸ³ docker-compose.yml ì£¼ìš” ì„œë¹„ìŠ¤

```yaml
services:
  backend-dev:
    build:
      context: ./backend-dev
    volumes:
      - ./backend-dev:/app
    ports:
      - "3001:3000"
    command: npm run start:dev
    networks:
      - app-net

  frontend-dev:
    build:
      context: ./frontend-dev
    volumes:
      - ./frontend-dev:/app
    ports:
      - "5174:5173"
    command: npm run dev
    networks:
      - app-net

  nginx:
    image: nginx:latest
    container_name: nginx
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx/conf.d:/etc/nginx/conf.d
      - ./nginx/logs:/var/log/nginx
      - ./nginx/certbot/www:/var/www/certbot
      - ./nginx/certbot/conf:/etc/letsencrypt
      - ./frontend-dev/dist:/usr/share/nginx/html  # prod ì‹œ
    networks:
      - app-net

networks:
  app-net:
```

---

## ğŸŒ nginx í”„ë¡ì‹œ ì„¤ì • ì˜ˆì‹œ (`test.domain.com.conf`)

```nginx
server {
    listen 80;
    server_name test.domain.com;

    location / {
        proxy_pass http://frontend-dev:5173;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    location /api/ {
        proxy_pass http://backend-dev:3000/;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

---

## âœ… ìƒíƒœ í™•ì¸ ë° ì¢…ë£Œ ëª…ë ¹ì–´

```bash
# ìƒíƒœ í™•ì¸
curl localhost:5174       # â†’ frontend dev
curl localhost:3001       # â†’ backend dev
curl localhost/api/       # â†’ nginx í†µí•´ ë°±ì—”ë“œë¡œ í”„ë¡ì‹œë¨

# dev ì„œë²„ ì¢…ë£Œ
docker compose stop frontend-dev backend-dev
```

---

âœ… ì´ì œ dev í™˜ê²½ ì™„ë£Œ!  
