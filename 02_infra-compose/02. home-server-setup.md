# ğŸ¡ í™ˆì„œë²„ êµ¬ì¶• ê¸°ì´ˆ ì •ë¦¬

---

## âœ… ê¸°ë³¸ ì „ì œ

- ë¦¬ëˆ…ìŠ¤ ì„œë²„ ì„¤ì¹˜ ì™„ë£Œ (UI ì—†ìŒ)
- SSH ì ‘ì† ê°€ëŠ¥ ìƒíƒœ
- `/home`ì€ ì¡´ì¬, `/opt`ëŠ” ë¹„ì–´ ìˆìŒ
- ê³µì¸ IP ì§ì ‘ í• ë‹¹ ê°€ëŠ¥í•˜ì§€ë§Œ, ê³µìœ ê¸° ì‚¬ìš©ìœ¼ë¡œ í¬íŠ¸í¬ì›Œë”© ê°€ëŠ¥

---

## ğŸ“ ë„¤íŠ¸ì›Œí¬ ì„¤ê³„

### â–¶ ê³µìœ ê¸° ë’¤ì— ë‘˜ ê²ƒì¸ê°€?
**ì¶”ì²œ: ê³µìœ ê¸° â†’ í™ˆì„œë²„ (ì‚¬ì„¤ IP + í¬íŠ¸í¬ì›Œë”©)**

| í•­ëª© | ì§ì ‘ ê³µì¸ IP ì‚¬ìš© | ê³µìœ ê¸° ì‚¬ìš© |
|------|-------------------|-------------|
| ì ‘ê·¼ í¸ì˜ | ì‰¬ì›€ | í¬íŠ¸í¬ì›Œë”© í•„ìš” |
| ë³´ì•ˆ | ë§¤ìš° ìœ„í—˜ | NATë¡œ 1ì°¨ ë³´í˜¸ |
| í™•ì¥ì„± | ì œí•œì  (ê³µì¸ IP ê°¯ìˆ˜ ì œí•œ) | ë‹¤ìˆ˜ ì„œë²„ ìš´ì˜ ê°€ëŠ¥ |

---

## ğŸ” ë³´ì•ˆ ì„¤ì •

### â–¶ `UFW` ë°©í™”ë²½ ì„¤ì • (ì§‘ì—ì„œ ë¨¼ì € í•´ì•¼ í•¨)

```bash
sudo apt update && sudo apt install ufw
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw allow 22       # SSH í¬íŠ¸
sudo ufw allow 80       # HTTP
sudo ufw allow 443      # HTTPS
sudo ufw enable
```

### â–¶ `fail2ban` ì„¤ì¹˜ (SSH ë¬´ì°¨ë³„ ê³µê²© ë°©ì§€)

```bash
sudo apt install fail2ban
sudo systemctl enable --now fail2ban
```

---

## ğŸ³ Docker ê¸°ë°˜ êµ¬ì„±

### â–¶ êµ¬ì„± ìš”ì†Œ

| ì„œë¹„ìŠ¤ | ì„¤ëª… |
|--------|------|
| Nginx | Reverse Proxy |
| Backend | NestJS / FastAPI ë“± |
| Frontend | React / Next.js / Svelte ë“± |
| MySQL | ê´€ê³„í˜• DB |
| PostgreSQL | ë˜ ë‹¤ë¥¸ RDB |
| Storage | MinIO ë“± ë¡œì»¬ S3 |

### â–¶ í´ë” êµ¬ì¡° ì˜ˆì‹œ

```plaintext
/opt/home-server/
â”œâ”€â”€ nginx/
â”‚   â”œâ”€â”€ conf.d/
â”‚   â””â”€â”€ docker-compose.yml
â”œâ”€â”€ backend/
â”‚   â””â”€â”€ docker-compose.yml
â”œâ”€â”€ frontend/
â”‚   â””â”€â”€ docker-compose.yml
â”œâ”€â”€ mysql/
â”‚   â””â”€â”€ docker-compose.yml
â”œâ”€â”€ postgresql/
â”‚   â””â”€â”€ docker-compose.yml
â”œâ”€â”€ storage/
â”‚   â””â”€â”€ docker-compose.yml
â”œâ”€â”€ .env
â””â”€â”€ docker-compose.yml (ì „ì²´ í†µí•©)
```

---

## ğŸ¤– Docker Compose vs Kubernetes

| í•­ëª© | Docker Compose | Kubernetes |
|------|----------------|------------|
| ì‚¬ìš© ëª©ì  | ê°œë°œ/ì†Œê·œëª¨ ë°°í¬ | ëŒ€ê·œëª¨ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ |
| ë³µì¡ë„ | ë‚®ìŒ (ë‹¨ì¼ íŒŒì¼) | ë†’ìŒ (ë‹¤ì–‘í•œ YAML êµ¬ì„±) |
| ìš´ì˜ ë°©ì‹ | ë‹¨ì¼ ì„œë²„ ì¤‘ì‹¬ | ë‹¤ì¤‘ ë…¸ë“œ í´ëŸ¬ìŠ¤í„° |
| ì¶”ì²œ ìƒí™© | í™ˆì„œë²„, ì†Œê·œëª¨ ì„œë¹„ìŠ¤ | ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤, í”„ë¡œë•ì…˜ ê·œëª¨ |

---

## ğŸ’¡ ê¸°íƒ€ íŒ

- `/opt`ëŠ” ìš´ì˜ìš© ì„œë¹„ìŠ¤ ë°°í¬ í´ë”ë¡œ ì‚¬ìš© (ê³µì‹ í‘œì¤€)
- `/home/kim`ì€ ê°œë°œ/í…ŒìŠ¤íŠ¸ìš© ì‘ì—… ê³µê°„ìœ¼ë¡œ ë¶„ë¦¬
- Git, Vim, Tmux, Docker CLI ë“±ì„ ì„œë²„ì— ë¯¸ë¦¬ ì„¤ì¹˜í•´ë‘ë©´ ìœ ìš©
- ì‹¤ì œ ìš´ì˜ ì „ì´ë¼ë©´ ë¡œì»¬ì—ì„œ Docker í™˜ê²½ ìµœëŒ€í•œ ë˜‘ê°™ì´ ë§ì¶°ì„œ í…ŒìŠ¤íŠ¸

---

## ğŸ“¦ ë‹¤ìŒ ë‹¨ê³„ ì œì•ˆ

- `docker-compose` í™˜ê²½ íŒŒì¼ ìƒì„±
- nginx + frontend + backend ì˜ˆì œ êµ¬ì„±ë¶€í„° ì‹œì‘
- í•„ìš”ì‹œ ì „ì²´ í†µí•© `docker-compose.yml` ì œê³µ ê°€ëŠ¥
---

## ğŸ§© ì˜ˆì‹œ: Docker Compose í…œí”Œë¦¿ + í´ë” êµ¬ì¡°

### ğŸ“ ê¸°ë³¸ í´ë” êµ¬ì¡°

```plaintext
/opt/home-server/
â”œâ”€â”€ nginx/
â”‚   â”œâ”€â”€ conf.d/
â”‚   â”‚   â””â”€â”€ default.conf
â”‚   â””â”€â”€ docker-compose.yml
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â””â”€â”€ docker-compose.yml
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â””â”€â”€ docker-compose.yml
â”œâ”€â”€ mysql/
â”‚   â””â”€â”€ docker-compose.yml
â”œâ”€â”€ postgresql/
â”‚   â””â”€â”€ docker-compose.yml
â”œâ”€â”€ storage/
â”‚   â””â”€â”€ docker-compose.yml
â”œâ”€â”€ .env
â””â”€â”€ docker-compose.yml (ì „ì²´ í†µí•© êµ¬ì„±)
```

---

### ğŸ“¦ ì „ì²´ í†µí•© docker-compose.yml ì˜ˆì‹œ

```yaml
version: '3.8'

services:
  nginx:
    image: nginx:latest
    ports:
      - "80:80"
    volumes:
      - ./nginx/conf.d:/etc/nginx/conf.d
      - ./frontend/dist:/usr/share/nginx/html
    depends_on:
      - backend
    networks:
      - app-net

  backend:
    build: ./backend
    ports:
      - "3000:3000"
    environment:
      - DB_HOST=mysql
      - DB_PORT=3306
      - DB_USER=user
      - DB_PASS=pass
    depends_on:
      - mysql
    networks:
      - app-net

  frontend:
    build: ./frontend
    networks:
      - app-net

  mysql:
    image: mysql:8.0
    environment:
      - MYSQL_ROOT_PASSWORD=secret
      - MYSQL_DATABASE=app_db
      - MYSQL_USER=user
      - MYSQL_PASSWORD=pass
    volumes:
      - mysql_data:/var/lib/mysql
    networks:
      - app-net

  postgresql:
    image: postgres:15
    environment:
      - POSTGRES_USER=user
      - POSTGRES_PASSWORD=pass
      - POSTGRES_DB=app_pgdb
    volumes:
      - pg_data:/var/lib/postgresql/data
    networks:
      - app-net

  storage:
    image: minio/minio
    command: server /data --console-address ":9001"
    environment:
      - MINIO_ROOT_USER=minio
      - MINIO_ROOT_PASSWORD=minio123
    volumes:
      - minio_data:/data
    ports:
      - "9000:9000"
      - "9001:9001"
    networks:
      - app-net

volumes:
  mysql_data:
  pg_data:
  minio_data:

networks:
  app-net:
```

---

### ğŸ’¡ ì´ í…œí”Œë¦¿ìœ¼ë¡œ ê°€ëŠ¥í•œ ê²ƒë“¤

- Nginxë¥¼ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œë¡œ ì‚¬ìš©
- NestJS ë˜ëŠ” FastAPI ë“± ë°±ì—”ë“œ ì„œë²„ì™€ ì—°ê²°
- React/Next ë“± í”„ë¡ íŠ¸ì—”ë“œ ì •ì  íŒŒì¼ ì œê³µ
- MySQLê³¼ PostgreSQLì„ ë™ì‹œì— ìš´ì˜
- MinIOë¡œ íŒŒì¼ ì €ì¥ (ë¡œì»¬ S3ì²˜ëŸ¼ ì‚¬ìš©)

ì´ì œ ì´ êµ¬ì¡°ë¡œ í™ˆì„œë²„ì— í•„ìš”í•œ ê±°ì˜ ëª¨ë“  ì„œë¹„ìŠ¤ë¥¼ ìœ ê¸°ì ìœ¼ë¡œ ë¬¶ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
